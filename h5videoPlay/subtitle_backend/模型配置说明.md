# 模型配置说明

## 概述

本系统支持多种语音转文字模型，通过统一的配置文件和UI界面进行管理。

## 配置文件

配置文件位置：`model_config.json`

首次运行时会自动创建默认配置文件。如果需要手动配置，可以参考 `model_config.example.json`。

## 支持的模型

### 1. Whisper (本地模型)

使用 faster-whisper 进行本地语音识别，无需网络连接。

**配置示例：**

```json
{
  "type": "whisper",
  "enabled": true,
  "config": {
    "model_size": "small",
    "device": "cpu",
    "compute_type": "int8",
    "cpu_threads": 4
  }
}
```

**参数说明：**

- `model_size`: 模型大小，可选值：`tiny`, `base`, `small`, `medium`, `large`, `auto`
- `device`: 计算设备，可选值：`cpu`, `cuda`, `auto`
- `compute_type`: 计算类型，可选值：`int8`, `float16`, `float32`
- `cpu_threads`: CPU线程数（仅CPU模式有效）

### 2. 硅基流动 (SiliconFlow API)

使用硅基流动的云端API进行语音识别，速度更快，但需要网络连接和API密钥。

**配置示例：**

```json
{
  "type": "siliconflow",
  "enabled": true,
  "config": {
    "api_key": "your-api-key-here",
    "base_url": "https://api.siliconflow.cn/v1",
    "model_id": "siliconflow/asr-paraformer-zh",
    "timeout": 30
  }
}
```

**参数说明：**

- `api_key`: 硅基流动的API密钥（必填）
- `base_url`: API基础URL（默认：`https://api.siliconflow.cn/v1`）
- `model_id`: 模型ID（默认：`siliconflow/asr-paraformer-zh`）
- `timeout`: 请求超时时间（秒，默认：30）

**获取API密钥：**

1. 访问 [硅基流动官网](https://siliconflow.cn)
2. 注册账号并获取API密钥
3. 将API密钥填入配置文件

## 使用方法

### 1. 配置模型

编辑 `model_config.json` 文件，设置模型参数。

### 2. 选择模型

运行程序后，在UI界面的底部控制栏中，可以看到"模型"下拉框，选择要使用的模型。

### 3. 切换模型

在运行时可以随时通过UI切换模型，系统会自动重新加载模型配置。

## 添加新模型

系统设计支持扩展，添加新模型需要：

1. 创建模型类，继承 `BaseSpeechToTextModel`
2. 实现 `initialize()`, `transcribe()`, `is_available()` 等方法
3. 在 `ModelManager` 中注册新模型类
4. 在配置文件中添加模型配置

## 注意事项

1. **API密钥安全**：请勿将包含真实API密钥的配置文件提交到版本控制系统
2. **模型切换**：切换模型时，旧模型会被清理，新模型会重新初始化
3. **网络连接**：使用API模型（如硅基流动）需要稳定的网络连接
4. **性能优化**：本地模型（Whisper）首次加载需要下载模型文件，请确保有足够的磁盘空间

## 故障排查

### 模型加载失败

- 检查配置文件格式是否正确（JSON格式）
- 检查模型配置参数是否有效
- 查看日志文件了解详细错误信息

### API模型请求失败

- 检查网络连接
- 验证API密钥是否正确
- 检查API服务是否可用
- 查看超时设置是否合理

### 模型切换失败

- 确保新模型已正确配置
- 检查模型是否已启用（`enabled: true`）
- 查看日志了解详细错误
