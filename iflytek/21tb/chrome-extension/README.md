# 21tb增强助手 - Chrome扩展版

这是一个针对21tb学习平台的Chrome浏览器扩展，提供视频播放控制和自动答题功能。

## ✨ 主要功能

### 1. 视频播放增强
- **滑块速度控制**：1-5倍速度调节，默认2倍速
- **键盘快捷键**：
  - `←` / `→` 键：快进/回退 10 秒
  - `1` / `2` / `3` / `4` / `5` 键：快速切换到 1/1.5/2/3/5 倍速
- **可视化控制面板**：悬浮在右下角的速度控制滑块

### 2. 考试自动答题
- 调用 Dify API 进行智能答题
- 支持单选题、多选题、判断题
- 暂停/继续控制
- 失败题目自动重试
- 实时状态显示

## 📦 安装步骤

### 1. 准备图标文件
在扩展目录中需要放置以下图标文件（PNG格式）：
- `icon16.png` - 16x16 像素
- `icon48.png` - 48x48 像素
- `icon128.png` - 128x128 像素

> **提示**：你可以使用任何图标生成工具创建这些图标，或者从网上找一个合适的图标。

### 2. 加载扩展到 Chrome

1. 打开 Chrome 浏览器
2. 在地址栏输入 `chrome://extensions/` 并回车
3. 在右上角开启"**开发者模式**"
4. 点击"**加载已解压的扩展程序**"
5. 选择 `chrome-extension` 文件夹
6. 扩展安装完成！

## ⚙️ 配置说明

### 首次使用配置

1. 点击浏览器工具栏中的扩展图标
2. 在弹出的设置面板中配置以下信息：

#### 必填项
- **Dify API Key** ⭐：从 Dify 平台获取的 API 密钥（格式：`app-xxxxxxxx`）

#### 可选项
- **AI 角色设定**：默认为"科大讯飞公司的规章制度专家"
- **AI 能力范围**：默认为"保密"
- **Dify API 地址**：默认为 Dify 官方地址
- **默认播放速度**：视频的默认播放速度（1-5倍，推荐2倍）

3. 点击"**保存配置**"按钮

### 获取 Dify API Key

1. 访问 [Dify 平台](https://dify.ai/)
2. 创建或打开你的工作流
3. 在 API 访问设置中获取 API Key
4. 复制以 `app-` 开头的密钥

## 🎯 使用方法

### 视频播放控制

1. 打开 21tb 平台的视频学习页面
2. 视频加载后，右下角会自动显示速度控制滑块
3. 拖动滑块调节播放速度（1-5倍）
4. 或使用键盘快捷键快速调速

**键盘快捷键：**
- `←` 键：后退 10 秒
- `→` 键：前进 10 秒
- `1` 键：1.0倍速
- `2` 键：1.5倍速
- `3` 键：2.0倍速
- `4` 键：3.0倍速
- `5` 键：5.0倍速

### 自动答题

1. 打开 21tb 平台的考试页面
2. 左下角会自动显示"自动答题控制台"
3. 确认 API 已配置（显示"✅ API已配置"）
4. 点击"**开始自动答题**"按钮
5. 系统会自动：
   - 识别题型（单选/多选/判断）
   - 提取题目和选项
   - 调用 AI 获取答案
   - 自动选择答案
6. 答题过程中可以：
   - 点击"**暂停**"按钮暂停答题
   - 点击"**继续**"按钮恢复答题
7. 如有失败题目，点击"**重试失败题目**"按钮重试

## 🔧 技术实现

### 与油猴脚本的区别

| 特性 | 油猴脚本 | Chrome扩展 |
|------|---------|-----------|
| 速度控制 | 点击切换固定档位 | 滑块连续调节1-5倍速 |
| 配置存储 | GM_setValue/GM_getValue | chrome.storage.sync |
| 网络请求 | GM_xmlhttpRequest | fetch API |
| 设置界面 | 油猴菜单 | 独立的弹窗设置页面 |
| 默认速度 | 1倍速 | 2倍速（可配置）|

### 文件结构

```
chrome-extension/
├── manifest.json       # 扩展配置文件
├── content.js          # 内容脚本（主要功能）
├── styles.css          # 样式文件
├── popup.html          # 设置弹窗页面
├── popup.js            # 设置弹窗脚本
├── icon16.png          # 16x16 图标
├── icon48.png          # 48x48 图标
├── icon128.png         # 128x128 图标
└── README.md           # 说明文档
```

## ⚠️ 注意事项

1. **API Key 安全**：请妥善保管你的 Dify API Key，不要分享给他人
2. **网络要求**：自动答题功能需要联网访问 Dify API
3. **浏览器兼容**：此扩展基于 Manifest V3，需要 Chrome 88+ 或其他支持 Manifest V3 的浏览器
4. **使用场景**：仅用于学习辅助，请遵守平台使用规则

## 🔄 更新日志

### v2.0.0 (Chrome扩展版)
- ✅ 将油猴脚本转换为 Chrome 扩展
- ✅ 速度控制改为滑块形式（1-5倍速）
- ✅ 默认播放速度改为 2 倍
- ✅ 使用 Chrome 存储 API 替代 GM_setValue
- ✅ 使用 fetch API 替代 GM_xmlhttpRequest
- ✅ 新增独立的设置弹窗界面
- ✅ 优化 UI 和用户体验

### v1.4.1 (油猴脚本原版)
- 基本的视频控制和自动答题功能
- 使用油猴菜单进行配置

## 📝 许可证

本项目仅供学习交流使用，请勿用于商业用途。

## 🤝 反馈与建议

如有问题或建议，欢迎提交 Issue 或 Pull Request。

---

**开发者**: yuan  
**版本**: 2.0.0  
**更新时间**: 2026-01

