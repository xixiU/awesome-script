# 推特AI助手

中文文档 | [English](README.md)

一个强大的推特/X油猴脚本，集成屏蔽评论者和AI智能总结两大功能。

## 功能特点

### 🚫 一键屏蔽评论者

- 🎯 一键屏蔽某条推文下的所有评论者
- 🔄 自动滚动加载所有评论
- 📊 实时显示处理进度
- ✅ 统计成功和失败数量
- ⚙️ 可配置是否排除原推作者

### 🤖 AI智能总结

- 📝 **推文详情页**：总结推文内容及评论，分析评论观点分布和讨论热点
- 👤 **用户主页**：总结用户的推文，分析用户关注话题和发言风格
- 🌐 支持自定义OpenAI兼容的API（OpenAI、Azure、本地部署等）
- 📊 可配置最大加载页数，控制内容量
- 🎨 精美的结果展示面板，支持全屏和复制

### 🌍 通用特性

- 🌐 多语言支持（中文/英文）- 自动检测系统语言
- 🎨 精美的悬浮按钮界面
- ⚙️ 丰富的配置选项

## 安装方法

### 1. 安装油猴插件

首先需要在浏览器中安装 Tampermonkey 扩展：

- **Chrome/Edge**: [Chrome 网上应用店](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
- **Firefox**: [Firefox 附加组件](https://addons.mozilla.org/zh-CN/firefox/addon/tampermonkey/)
- **Safari**: [Mac App Store](https://apps.apple.com/app/tampermonkey/id1482490089)

### 2. 安装脚本

安装完 Tampermonkey 后：

1. 点击浏览器工具栏中的 Tampermonkey 图标
2. 选择"添加新脚本"
3. 将 `twitter_block_commenters.user.js` 文件中的代码完整复制粘贴到编辑器中
4. 按 `Ctrl + S`（Mac: `Cmd + S`）保存

## 使用方法

### 功能一：屏蔽评论者

#### 1. 打开推文详情页

在推特/X上打开任意一条推文的详情页（URL格式：`https://x.com/用户名/status/推文ID`）

#### 2. 点击屏蔽按钮

页面右上角会出现紫色渐变的悬浮按钮 **"🚫 屏蔽所有评论者"**

#### 3. 确认并执行

点击按钮后确认，脚本将：

1. 自动滚动加载所有评论
2. 提取所有评论者的用户名
3. 逐个屏蔽每位评论者
4. 显示实时进度和统计信息

### 功能二：AI智能总结

#### 1. 配置AI API（首次使用）

点击油猴图标 → 脚本设置 → ⚙️ 打开TwitterAIHelper配置，设置：

- **OpenAI API地址**：API基础地址（如：`https://api.openai.com/v1`）
- **API密钥**：你的OpenAI API Key
- **AI模型**：模型名称（如：`gpt-3.5-turbo`、`gpt-4`）
- **最大加载页数**：控制加载评论/推文的页数（默认：10）

#### 2. 使用AI总结

**在推文详情页**：

- 点击粉色渐变的 **"🤖 AI总结"** 按钮
- 脚本将自动加载推文和评论，并生成总结
- 总结内容包括：原推核心观点、评论观点分布、讨论热点、舆论倾向

**在用户主页**：

- 点击 **"🤖 AI总结"** 按钮
- 脚本将加载用户的推文，并生成总结
- 总结内容包括：主要关注话题、发言风格、核心观点、活跃主题

#### 3. 查看和操作结果

总结完成后将弹出结果面板，支持：

- 📄 **复制**：一键复制总结内容
- 🖥️ **全屏**：全屏查看总结
- ❌ **关闭**：关闭结果面板

## 配置选项

点击油猴图标 → 脚本设置 → ⚙️ 打开TwitterAIHelper配置，可进行以下设置：

### 屏蔽功能配置

- **排除原推作者**：不屏蔽发推文的人（默认：开启）
- **最大滚动次数**：加载所有评论的最大滚动尝试次数（默认：3，范围：1-20）

### AI总结功能配置

- **OpenAI API地址**：OpenAI兼容的API基础地址（默认：`https://api.openai.com/v1`）
- **API密钥**：你的OpenAI API Key（必填）
- **AI模型**：使用的模型名称（默认：`gpt-3.5-turbo`）
- **最大加载页数**：加载评论/推文的最大页数（默认：10，范围：1-50）

## 注意事项

⚠️ **重要提示**：

### 屏蔽功能

1. **不可撤销**：屏蔽操作完成后，需要手动到设置中解除屏蔽
2. **速率限制**：脚本已内置延迟（每个用户间隔1秒），避免触发推特的速率限制
3. **仅限详情页**：屏蔽功能必须在推文详情页使用
4. **谨慎使用**：建议只在真正需要的时候使用，避免误伤无辜用户

### AI总结功能

1. **API密钥安全**：请妥善保管你的API Key，不要分享给他人
2. **API费用**：使用OpenAI API会产生费用，请注意控制使用量
3. **兼容性**：支持所有OpenAI兼容的API服务（如Azure OpenAI、本地部署的模型等）
4. **加载时间**：根据内容量和网络情况，总结可能需要10-60秒
5. **权限要求**：需要登录推特账号才能查看内容

## 工作原理

### 屏蔽功能

1. **评论加载**：自动滚动页面，触发推特的懒加载机制，加载更多评论
2. **用户识别**：解析页面DOM结构，提取所有评论者的用户名
3. **UI操作**：模拟用户点击操作（点击"..."菜单 → 点击"屏蔽" → 确认屏蔽）
4. **进度反馈**：实时更新按钮状态，显示处理进度

### AI总结功能

1. **页面类型检测**：自动识别当前页面类型（推文详情页/用户主页）
2. **内容提取**：
   - 推文详情页：提取原推内容 + 自动滚动加载评论
   - 用户主页：自动滚动加载用户的推文
3. **内容组织**：将提取的内容格式化为结构化数据
4. **API调用**：调用OpenAI兼容的API进行智能总结
5. **结果展示**：在精美的面板中展示Markdown格式的总结结果

## 技术栈

- 原生 JavaScript
- Tampermonkey GM API
  - `GM_setValue` / `GM_getValue`：持久化配置存储
  - `GM_xmlhttpRequest`：跨域API调用
  - `GM_addStyle`：注入样式
  - `GM_registerMenuCommand`：注册菜单命令
- DOM 操作
- MutationObserver（监听路由变化）
- OpenAI API（通过代理支持各种兼容的AI服务）

## 常见问题

### 屏蔽功能相关

#### Q: 为什么有些用户屏蔽失败？

A: 可能的原因：

- 用户已经被屏蔽
- 用户账号已被删除或冻结
- 网络延迟导致页面元素未加载完成
- 推特页面结构变化

### Q: 可以批量解除屏蔽吗？

A: 脚本目前只支持屏蔽功能，解除屏蔽需要：

1. 进入设置 → 隐私和安全 → 已屏蔽的账号
2. 手动逐个解除屏蔽

### Q: 会不会被推特封号？

A: 脚本已经内置了合理的延迟机制，模拟真实用户操作，正常使用不会导致封号。但请：

- 不要频繁使用
- 不要短时间内屏蔽大量用户
- 遵守推特使用条款

#### Q: 支持移动端吗？

A: 脚本主要针对桌面端浏览器设计，移动端浏览器通常不支持油猴插件。

### AI总结功能相关

#### Q: 支持哪些AI服务？

A: 支持所有OpenAI兼容的API服务，包括：

- OpenAI官方API（`https://api.openai.com/v1`）
- Azure OpenAI Service
- 国内API代理服务
- 本地部署的兼容模型（如LocalAI、vLLM等）

只需在配置中填写正确的API地址和密钥即可。

#### Q: 为什么总结失败或超时？

A: 可能的原因：

- API密钥未配置或已失效
- API地址配置错误
- 网络连接问题
- API服务暂时不可用
- 请求超时（默认60秒）

#### Q: 如何节省API费用？

A: 建议：

- 使用 `gpt-3.5-turbo` 而非 `gpt-4`（便宜约10倍）
- 减少"最大加载页数"配置（默认10页）
- 只在需要时使用总结功能
- 考虑使用本地部署的模型

#### Q: 总结的内容是什么语言？

A: 无论原文使用何种语言，总结都会使用**中文**输出，并采用结构化的Markdown格式，便于阅读。

#### Q: 可以自定义总结的提示词吗？

A: 当前版本暂不支持自定义提示词，使用内置的优化提示词。未来版本可能会添加此功能。

## 更新日志

### v2.0 (2026-02-09)

- 🚀 **重大更新**：新增AI智能总结功能
- 🤖 支持总结推文和评论（推文详情页）
- 👤 支持总结用户推文（用户主页）
- 🌐 支持所有OpenAI兼容的API服务
- 📊 可配置最大加载页数
- 🎨 精美的结果展示面板，支持全屏和复制
- 🔧 重命名为"推特AI助手"，集成屏蔽和AI总结两大功能
- ⚙️ 更新配置管理器，支持更多配置选项

### v1.4 (2026-02-01)

- ✨ 新增可配置的最大滚动次数（默认：3次，可调整范围：1-20）
- 🔧 优化评论加载性能，支持自定义滚动行为

### v1.3 (2026-02-01)

- ✨ 新增配置选项：排除原推作者（默认开启，不屏蔽发推文的人）
- 🔧 集成 ConfigManager 实现配置管理
- 🌐 支持多语言（中文/英文），自动检测系统语言
- 🎯 一键屏蔽推文下的所有评论者
- 🔄 自动加载所有评论并显示实时进度
- 🎨 精美的悬浮按钮界面

## 许可证

MIT License

## 作者

xixiU

## 贡献

欢迎提交 Issue 和 Pull Request！

## 免责声明

本脚本仅供学习交流使用，使用者需自行承担使用本脚本产生的一切后果。作者不对使用本脚本造成的任何损失负责。
